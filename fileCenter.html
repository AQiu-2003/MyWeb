<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>MyWeb - MeMeMe!</title>
    <link rel="Shortcut Icon" href="images/favicon.ico" />
    <link rel="apple-touch-icon" href="images/favicon.ico" />
    <link rel="stylesheet" href="styles/normalize.css" />
    <link rel="stylesheet" href="styles/animate.min.css">
    <link rel="stylesheet" href="styles/style.css" />
    <style>
        #fileTransfer {
          margin-top: 2rem;
          font-size: 1.5rem;
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .uploadMenu {
          display: block;
        }
        #fileViewer {
          margin-top: 3rem;
          height: 30rem;
        }
        #fileViewer iframe {
          width: 100%;
          height: 100%;
          border: none;
        }
      </style>
    <script src="script.js"></script>
  </head>
  <body>
    <header class="top-bar">
      <h1><a href="index.html">MyWeb</a></h1>
      <nav>
        <ul class="nav-items">
            <li><a href="fileCenter.html">è¯¾ä»¶ä¸­å¿ƒ</a></li>
            <li><a href="personalCenter.html">ä¸ªäººä¸­å¿ƒ</a></li>
          <li><a href="#" onclick="logout()">ç™»å‡º</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <div class="main-content">
        <h2>åœ¨è¿™é‡Œä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ï¼</h2>
        <p>å¦‚æœæ˜¯å­¦ç”Ÿçš„è¯ï¼Œå°±åªèƒ½ä¸‹è½½äº†å§ğŸ¤”ï¸</p>
        <p>æ‚¨å¯ä»¥ä¸Šä¼ .ppt/.pptx/.keyæ–‡ä»¶</p>
      </div>
      
      <div class="action-card">
        <div id="message-card" class="animate__bounceIn" style="display: none;">æœåŠ¡å™¨ä¼ å›æ¶ˆæ¯</div>
        
      <div id="fileTransfer">
        <div class="uploadMenu">
          <input type="file" id="fileInput" value="é€‰æ‹©æ–‡ä»¶">
          <button id="uploadButton">ä¸Šä¼ æ–‡ä»¶</button>
        </div>
        <div id="fileViewer">
          <iframe src="php/getFileList.php" frameborder="0"></iframe>
        </div>
      </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2023 MyWeb - By AQiu</p>
    </footer>

    <script>
        var userInfo = getLoginCookie();
        if(userInfo == null)
            window.location.href = './login.html';
        if(userInfo.type == 'student') {
            document.getElementsByClassName('uploadMenu')[0].style.display = 'none';
            document.querySelector("p:last-child").style.display = 'none';
        }

    </script>
    <script>
        // å½“ä¸Šä¼ æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘
        document.getElementById('uploadButton').addEventListener('click', function() {
          var fileInput = document.getElementById('fileInput');
          var file = fileInput.files[0]; // è·å–é€‰æ‹©çš„æ–‡ä»¶
    
          if (file) {
            var formData = new FormData();
            formData.append('file', file); // åˆ›å»ºä¸€ä¸ªè¡¨å•æ•°æ®å¯¹è±¡ï¼Œå°†æ–‡ä»¶æ·»åŠ åˆ°å…¶ä¸­
    
            // å‘é€POSTè¯·æ±‚åˆ°åç«¯
            fetch('php/uploadFile.php', {
              method: 'POST',
              body: formData
            })
            .then(function(response) {
              if (response.ok) {
                messageCard('ä¸Šä¼ æˆåŠŸï¼', 'success');
                // åˆ·æ–°æ–‡ä»¶åˆ—è¡¨
                document.getElementById('fileViewer').innerHTML = '<iframe src="php/getFileList.php" frameborder="0"></iframe>';
                setTimeout(function() {
                  hideMessageCard();
                }, 2000);
              } else {
                messageCard('ä¸Šä¼ å¤±è´¥ï¼è¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼ï¼');
              }
            })
            .catch(function(error) {
              console.log(error);
            });
          }
        });
      </script>
  </body>
</html>
